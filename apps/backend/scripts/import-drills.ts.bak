import { PrismaClient } from '@prisma/client';
import { readFileSync } from 'fs';
import { join } from 'path';

const prisma = new PrismaClient();

async function importDrills() {
  try {
    // Read the JSON file from project root
    const drillsPath = join(process.cwd(), '../../football_drills_135.json');
    console.log('üìÅ Reading from:', drillsPath);
    
    const drillsData = JSON.parse(readFileSync(drillsPath, 'utf-8'));

    console.log(`üì• Found ${drillsData.length} drills to import...\n`);

    let imported = 0;
    let skipped = 0;

    for (const drill of drillsData) {
      // Check if drill already exists by name
      const existing = await prisma.drill.findFirst({
        where: { name: drill.name },
      });

      if (existing) {
        console.log(`‚è≠Ô∏è  Skipping: ${drill.name}`);
        skipped++;
        continue;
      }

      // Create the drill
      await prisma.drill.create({
        data: {
          name: drill.name,
          description: drill.description,
          duration: drill.duration,
          category: drill.category,
          ageGroup: drill.age_group,
          equipment: drill.equipment,
          purpose: drill.purpose,
        },
      });

      imported++;
      if (imported % 10 === 0) {
        console.log(`‚úÖ Progress: ${imported}/${drillsData.length}...`);
      }
    }

    console.log('\nüéâ Import completed!');
    console.log(`‚úÖ Imported: ${imported} drills`);
    console.log(`‚è≠Ô∏è  Skipped: ${skipped} drills (already exist)`);
    console.log(`üìä Total: ${drillsData.length} drills`);

  } catch (error) {
    console.error('‚ùå Import failed:', error);
    process.exit(1);
  } finally {
    await prisma.$disconnect();
  }
}

importDrills();
